<div class="bg-gradient-to-br from-red-50 via-white to-red-50 p-6 pb-6">
  <div class="max-w-4xl mx-auto w-full">

    <!-- Header -->
    <div class="text-center mb-9">
      <div class="mb-4">
        <img src="assets/images/ssacs-logo.png" alt="SSACS Logo" class="w-[105px] h-[105px] mx-auto object-cover" />
      </div>
      <h1 class="text-4xl font-bold text-red-600 mb-2">Take the Quiz</h1>
      <!-- <p class="text-lg text-red-700 mb-2">Sikkim State AIDS Control Society</p>
    <p class="text-lg text-gray-600">Test your knowledge about HIV/AIDS awareness and prevention!</p> -->
    </div>

    <!-- Note Section -->
    <!-- <div class="mt-4 mb-8 max-w-4xl mx-auto text-center">
    <div class="bg-red-50 border-2 border-red-200 rounded-xl p-6">
      <h3 class="text-xl font-bold text-red-700 mb-2">ðŸ’¡ Note</h3>
      <p class="text-gray-700">
        Please read each question carefully. Your participation helps spread awareness.
      </p>
    </div>
  </div> -->
    <div *ngIf="showForm">
    <form #form="ngForm" (ngSubmit)="onSubmit(form)">
      <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border-2 border-red-200">
        <h3 class="text-xl font-semibold mb-4">Basic Details</h3>
        <div class="border-b border-gray-300 mb-4"></div>

        <!-- Contact Number -->
        <label class="block mb-2 font-medium">
          Contact Number <span class="text-red-700">*</span>
        </label>
        <input type="text"
               name="contact_no"
               [(ngModel)]="formDetails.contact_no"
               #contact_no="ngModel"
               required
               minlength="10"
               maxlength="10"
               pattern="^[0-9]{10}$"
               placeholder="Enter Contact Number"
               oninput="this.value = this.value.replace(/[^0-9]/g, '')"
               class="border rounded px-3 py-2 w-full mb-2 no-spinners" />
        <div *ngIf="form.submitted && contact_no.invalid" class="text-red-500 text-sm mb-2">
          <div *ngIf="contact_no.errors?.['required']">Contact number is required.</div>
          <div *ngIf="contact_no.errors?.['pattern'] || contact_no.errors?.['minlength'] || contact_no.errors?.['maxlength']">
            Contact number must be exactly 10 digits.
          </div>
        </div>

        <!-- Age -->
        <label class="block mb-2 font-medium">
          Age <span class="text-red-700">*</span>
        </label>
        <input type="text"
               name="age"
               [(ngModel)]="formDetails.age"
               #age="ngModel"
               required
               minlength="1"
               maxlength="2"
               pattern="^[0-9]{1,2}$"
               placeholder="Enter Your Age"
               oninput="this.value = this.value.replace(/[^0-9]/g, '')"
               class="border rounded px-3 py-2 w-full mb-2 no-spinners" />
        <div *ngIf="form.submitted && age.invalid" class="text-red-500 text-sm mb-2">
          <div *ngIf="age.errors?.['required']">Age is required.</div>
          <div *ngIf="age.errors?.['pattern'] || age.errors?.['maxlength'] || age.errors?.['minlength']">
            Age must be a valid number (max 2 digits).
          </div>
        </div>

        <!-- Gender -->
        <label class="block mb-2 font-medium">
          Gender <span class="text-red-700">*</span>
        </label>
        <select name="gender"
                [(ngModel)]="formDetails.gender"
                #gender="ngModel"
                required
                class="border rounded px-3 py-2 w-full mb-2">
          <option value="" disabled>Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Others">Others</option>
        </select>
        <div *ngIf="form.submitted && gender.invalid" class="text-red-500 text-sm mb-2">
          Gender is required.
        </div>

        <!-- Actions -->
        <div class="flex justify-end space-x-4 mt-6">
          <button type="button" class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400"
                  (click)="reset(form)">
            Reset
          </button>
          <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
            Proceed to Quiz
          </button>
        </div>
      </div>
    </form>
    </div>

    <div *ngIf="!showForm">
      <!-- Quiz Section -->
      <div *ngIf="!quizOver; else resultTemplate">
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border-2 border-red-200">
          <div class="flex justify-between items-center mb-6">
            <div class="flex items-center">
              <div class="rounded-full object-cover border-2 border-red-500 shadow-lg mr-4 p-2">
                <img src="assets/images/ssacs-logo.png" alt="SACS Logo" class="w-12 h-12">
              </div>
              <div>
                <h1 class="text-3xl font-bold text-red-600">SSACS Quiz</h1>
                <p class="text-sm text-red-700">Sikkim State AIDS Control Society</p>
              </div>
            </div>
            <div class="text-right">
              <div class="text-sm text-gray-600">Question</div>
              <div class="text-2xl font-bold text-red-600">{{ currentQuestionIndex + 1 }} / {{ questions.length }}</div>
            </div>
          </div>

          <!-- Progress Bar -->
          <div class="w-full bg-gray-200 rounded-full h-3 mb-6">
            <div class="bg-gradient-to-r from-red-500 to-red-700 h-3 rounded-full"
                 [style.width.%]="((currentQuestionIndex + 1) / questions.length) * 100">
            </div>
          </div>

          <!-- Score + Timer -->
          <div class="flex justify-between items-center">
            <div class="text-lg text-gray-600">
              Score: <span class="font-bold text-green-600">{{ score }}</span>
            </div>
            <div class="text-lg text-gray-600">
              Time: <span class="font-bold text-orange-600">{{ timeLeft }}s</span>
            </div>
          </div>
        </div>

        <!-- Question Card -->
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border-2 border-red-200">
          <h2 class="text-2xl font-semibold text-gray-800 mb-6">
            {{ questions[currentQuestionIndex].question }}
          </h2>

          <!-- Answer Options -->
          <div class="space-y-4">
            <button *ngFor="let choice of questions[currentQuestionIndex].options; let i = index"
                    (click)="selectAnswer(i)"
                    [ngClass]="{
                'border-green-500 bg-green-100': i === correctChoiceIndex,
                'border-red-500 bg-red-100': selectedChoiceIndex === i && i !== correctChoiceIndex,
                'border-gray-200': selectedChoiceIndex !== i && i !== correctChoiceIndex
              }"
                    class="w-full p-4 text-left border-2 rounded-xl transition-all duration-200"
                    [disabled]="isOptionDisabled">
              <span class="font-semibold text-gray-700">{{ 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[i] }}.</span>
              {{ choice.option_text }}
            </button>
          </div>
        </div>
      </div>

      <!-- <button (click)="resetUsedCoupons()" class="btn-reset">Reset Coupons</button> -->
      <!-- Results -->
      <ng-template #resultTemplate>
        <div class="bg-white rounded-2xl shadow-xl p-8 text-center border-2 border-red-200">
          <h2 class="text-3xl font-bold text-red-600 mb-4">Quiz Result</h2>
          <p class="text-2xl text-gray-700 mb-6 mt-6">
            Your score: <span class="font-bold text-green-600">
              {{
 score
              }}
            </span>
          </p>
          <p [ngClass]="['text-xl', 'text-' + messageColor + '-700', 'mb-6']" [innerHTML]="winMessage"></p>
        </div>
      </ng-template>
    </div>
    <!-- Sponsors / Partners Section -->
    <div class="mb-5">
      <div class="bg-white rounded-3xl shadow-xl px-8 pb-8 pt-0 mt-14 border-2 border-red-200 overflow-hidden h-72 flex flex-col justify-center">
        <h2 class="text-3xl font-bold text-red-600 mb-20 p-0">Our Sponsors & Partners</h2>
        <div class="relative overflow-hidden">
          <div class="flex gap-16 " [ngClass]="business.length> 8 ? 'animate-scroll' : '' ">
            <img *ngFor="let sponsor of business" [src]="imageApiUrl + sponsor.image_path" alt="Sponsor Logo"
                 class="h-16 w-auto object-contain flex-shrink-0" />
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
